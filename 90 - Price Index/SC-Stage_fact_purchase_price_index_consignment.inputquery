SELECT [SC-Stage_purchase_consignment.company_code], [SC-Stage_purchase_consignment.supplier_code], [SC-Stage_purchase_consignment.mat_doc_number], [SC-Stage_purchase_consignment.mat_doc_year], [SC-Stage_purchase_consignment.Mat_ Doc_Item], [SC-Stage_purchase_consignment.posting_date], [SC-Stage_purchase_consignment.plant_code], [SC-Stage_purchase_consignment.material_code], [SC-Stage_purchase_consignment.withdrawal_qty], [SC-Stage_purchase_consignment.uom_code], [SC-Stage_purchase_consignment.amount], [SC-Stage_purchase_consignment.curr_code], [SC-Stage_purchase_consignment.invoice_no], [SC-Stage_purchase_consignment.doc_year], [SC-Stage_purchase_consignment.Item], [SC-Stage_purchase_consignment.net_price], [SC-Stage_purchase_consignment.price_unit], [SC-Stage_purchase_consignment.Unit of measure], [SC-Stage_purchase_consignment.active] FROM [SC-Stage_purchase_consignment] INNER JOIN SELECT max([SC-Stage_PI_Fact.rate]) FROM [SC-Stage_PI_Fact] 
ON [SC-Stage_purchase_consignment.company_code]=[SC-Stage_PI_Fact.company_code] AND [SC-Stage_purchase_consignment.curr_code]=[SC-Stage_PI_Fact.curr_code] AND datepart(year, [SC-Stage_purchase_consignment.posting_date])=datepart(year, [SC-Stage_PI_Fact.posting_date]) AND datepart(month, [SC-Stage_purchase_consignment.posting_date])=datepart(month, [SC-Stage_PI_Fact.posting_date])