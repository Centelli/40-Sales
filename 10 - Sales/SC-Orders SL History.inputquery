Select Distinct [Grain(Sc-Orders Sl History).Sales Order Number], [Grain(Sc-Orders Sl History).Sales Order Item], [Grain(Sc-Orders Sl History).Sales Org Key], [Grain(Sc-Orders Sl History).Customer Key], [Grain(Sc-Orders Sl History).Item Key], [Grain(Sc-Orders Sl History).Rejection Reason Key], [Grain(Sc-Orders Sl History).Division Key],[Grain(Sc-Orders Sl History).Delivery Customer Key],[Grain(Sc-Orders Sl History).Order Qty], [Grain(Sc-Orders Sl History).# Order Intake Dc], [Grain(Sc-Orders Sl History).# Order Intake Gc], [Grain(Sc-Orders Sl History).# Order Intake Hc], [Grain(Sc-Orders Sl History).Analysis Date], [Grain(Sc-Orders Sl History).# Sales Order Key], [Grain(Sc-Orders Sl History).# Current Record], [Grain(Sc-Orders Sl History).Custarea Key], [Grain(Sc-Orders Sl History).# Delmarker], [Grain(Sc-Orders Sl History).# Source], [Grain(Sc-Orders Sl History).# So Item Cost Dc], [Grain(Sc-Orders Sl History).# So Item Cost Gc], [Grain(Sc-Orders Sl History).# So Item Cost Hc], [Grain(Sc-Orders Sl History).Comp Code Key], [Grain(Sc-Orders Sl History).# Sales Order Scl Line], [Grain(Sc-Orders Sl History).# Security Key], [Grain(Sc-Orders Sl History).# Order Intake Rc], [Grain(Sc-Orders Sl History).# So Item Cost Rc]
  From [Grain(Sc-Orders Sl History)] Where [Grain(Sc-Orders Sl History).# Current Record] = 1  
Inner Join 
Select [Level(Sales Order.Sales Order).Sales Order Number], [Level(Sales Order.Sales Order).Sales Order Item], [Level(Sales Order.Sales Order).So Date], [Level(Sales Order.Sales Order).So Document Category], [Level(Sales Order.Sales Order).So Transaction Group], [Level(Sales Order.Sales Order).So Document Type], [Level(Sales Order.Sales Order).Distr Channel], [Level(Sales Order.Sales Order).So Doc Condition], [Level(Sales Order.Sales Order).So Header Change Date], [Level(Sales Order.Sales Order).Item Category], [Level(Sales Order.Sales Order).Base Unit], [Level(Sales Order.Sales Order).Plant], [Level(Sales Order.Sales Order).Currency Key Dc], [Level(Sales Order.Sales Order).Ex Rate Dc], [Level(Sales Order.Sales Order).Currency Key Gc], [Level(Sales Order.Sales Order).Ex Rate Gc], [Level(Sales Order.Sales Order).Currency Key Hc], [Level(Sales Order.Sales Order).Ex Rate Hc], [Level(Sales Order.Sales Order).Pricing Date], [Level(Sales Order.Sales Order).Sales Order Key], [Level(Sales Order.Sales Order).So Item Delivery Status], [Level(Sales Order.Sales Order).So Order Delivery Status], [Level(Sales Order.Sales Order).So Item Rejection Status], [Level(Sales Order.Sales Order).So Item Overall Status], [Level(Sales Order.Sales Order).Change Date], [Level(Sales Order.Sales Order).Delmarker], [Level(Sales Order.Sales Order).Source], [Level(Sales Order.Sales Order).Requirement Type Key], [Level(Sales Order.Sales Order).Object Number], [Level(Sales Order.Sales Order).Scl Delivery Date], [Level(Sales Order.Sales Order).Scl Category], [Level(Sales Order.Sales Order).Scl Type], [Level(Sales Order.Sales Order).Scl Requirement Type], [Level(Sales Order.Sales Order).Scl Quantity], [Level(Sales Order.Sales Order).Sales Order Scl Line], [Level(Sales Order.Sales Order).Current Record], [Level(Sales Order.Sales Order).Currency Key Rc], [Level(Sales Order.Sales Order).Ex Rate Rc]
  From [Level(Sales Order.Sales Order)]
  On [Grain(Sc-Orders Sl History).Sales Order Number] = [Level(Sales Order.Sales Order).Sales Order Number] And [Grain(Sc-Orders Sl History).Sales Order Item] = [Level(Sales Order.Sales Order).Sales Order Item] And [Grain(Sc-Orders Sl History).# Sales Order Scl Line] = [Level(Sales Order.Sales Order).Sales Order Scl Line] And [Level(Sales Order.Sales Order).Current Record] = 1
Inner Join 
Select Distinct [Src.Sales Order Number],[Src.Sales Order Item], [Src.Analysis Date], [Src.So Header Change Date], [Src.Pricing Date] From [Sc-Orders Sl] 'Src'
  On [Src.Sales Order Number] = [Grain(Sc-Orders Sl History).Sales Order Number] And [Src.Sales Order Item] = [Grain(Sc-Orders Sl History).Sales Order Item]